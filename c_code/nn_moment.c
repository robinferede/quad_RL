#include "nn_thrust.h"
#include <stdio.h>
#include <math.h>

const float nn_moment_weights_fc1[] = {
0.13479341566562653, 0.5444170832633972, -0.190367192029953, -0.030209407210350037, -0.0458688884973526, 0.0034527687821537256, 0.06487298011779785, 0.009300940670073032, -0.019466841593384743, -0.0017629086505621672,
0.08114328235387802, -0.052618373185396194, -0.4986374080181122, 0.14595115184783936, -0.15981391072273254, 0.0335305780172348, 0.0908358097076416, 0.010529350489377975, -0.01974962279200554, -0.04436153545975685,
0.11256121098995209, -0.20993514358997345, 0.18167300522327423, -0.019135816022753716, -0.01389784924685955, 0.027440447360277176, 0.21894803643226624, 0.009867077693343163, 0.03211310878396034, 0.0707297995686531,
0.24115142226219177, 0.31886395812034607, -0.15658257901668549, -0.387006551027298, 0.00735539011657238, -0.07727497816085815, -0.03234907239675522, 0.01972842775285244, -0.04640231654047966, 0.09080249071121216,
0.009593826718628407, 0.01727513037621975, -0.26377883553504944, -0.22401557862758636, -0.20282039046287537, -0.02988075651228428, 0.07525656372308731, -0.005623314063996077, -0.014685302041471004, 0.0167307760566473,
-0.2837284803390503, 0.0409851036965847, 0.136122927069664, -0.1949152797460556, -0.03796697407960892, -0.1926698386669159, -0.051847513765096664, 0.03905808925628662, 0.006667242385447025, 0.01883450523018837,
0.15988384187221527, -0.2058490663766861, -0.39241984486579895, 0.16344144940376282, 0.05625274032354355, 0.06721816211938858, -0.05065852776169777, -0.024528348818421364, 0.02309413254261017, -0.04102102294564247,
-0.292656809091568, -0.270327091217041, -0.20342905819416046, -0.08722745627164841, -0.02478627674281597, -0.10474061220884323, 0.2732694447040558, -0.014890064485371113, -0.029311487451195717, 0.042745381593704224,
-0.09543447941541672, 0.08338797837495804, 0.051029007881879807, -0.11375291645526886, -0.11878056079149246, -0.0032822606153786182, -0.046853240579366684, 0.012246047146618366, -0.023472540080547333, -0.01036282628774643,
-0.1566772609949112, 0.17579145729541779, 0.8055437207221985, -0.07302261888980865, 0.02285718359053135, 0.00020097479864489287, 0.024165932089090347, 0.03006969764828682, -0.028510261327028275, -0.02381674386560917,
0.13095863163471222, -0.5192457437515259, -0.19974194467067719, 0.148191899061203, -0.006415257696062326, -0.05812262371182442, -0.12132352590560913, -0.013554733246564865, 0.012569375336170197, 0.032005708664655685,
0.39295971393585205, 0.004211083985865116, -0.09525712579488754, 0.3627135753631592, 0.00428948225453496, -0.006144913844764233, -0.0169221181422472, 0.01988561823964119, -0.011461503803730011, -0.02358480915427208,
0.3509231507778168, -0.06373085081577301, -0.08816949278116226, 0.5322256088256836, 0.007762998808175325, -0.05424656718969345, 0.157993346452713, 0.007447858341038227, 0.00905107706785202, -0.04597822576761246,
-0.40122345089912415, -0.3335159420967102, 0.24237611889839172, 0.2716681957244873, 0.04777899384498596, -0.0448048859834671, -0.05468091741204262, 0.017186662182211876, 0.019444795325398445, 0.030631063506007195,
-0.14654548466205597, 0.18465732038021088, 0.030605092644691467, -0.29131847620010376, -0.043255433440208435, -0.105298712849617, 0.11691075563430786, -0.03563627973198891, 0.011625165119767189, -0.09328513592481613,
-0.04103577882051468, 0.02968614734709263, -0.03010515868663788, 0.1581655889749527, 0.04823126643896103, 0.021172739565372467, 0.15645870566368103, -0.0250221136957407, -0.014667877927422523, -0.005600023549050093,
0.17969511449337006, 0.22907106578350067, -0.06233998015522957, -0.28489410877227783, 0.01829354837536812, -0.09759880602359772, 0.027923034504055977, 0.017966164276003838, -0.01642274484038353, 0.03984642028808594,
-0.03352293372154236, -0.3005504310131073, -0.3038632273674011, -0.007691170554608107, -0.021690675988793373, 0.08944164216518402, 0.2732210159301758, 0.007614264730364084, 0.012892493978142738, 0.04828958213329315,
-0.10580627620220184, 0.18186356127262115, -0.08748660236597061, -0.19981138408184052, -0.07686079293489456, 0.09146568179130554, -0.05283249914646149, -0.017309105023741722, -0.0039044867735356092, -0.053603146225214005,
-0.3464360535144806, 0.006206534802913666, -0.10937227308750153, 0.3492273986339569, 0.003192401025444269, -0.0864080935716629, 0.07118318974971771, -0.04138420522212982, 0.008187951520085335, -0.07682600617408752,
0.6811379194259644, -0.0507613904774189, -0.2562817633152008, -0.05845854431390762, 0.027496084570884705, -0.04112100973725319, 0.23637360334396362, -0.037522826343774796, -0.05117112025618553, 0.0730748251080513,
-0.012428893707692623, 0.14145983755588531, 0.15544795989990234, -0.025650629773736, 0.003531048772856593, -0.19264338910579681, 0.030402032658457756, 0.016993874683976173, 0.017016006633639336, 0.03222094103693962,
-0.18495696783065796, -0.31469351053237915, -0.08747300505638123, 0.08013109862804413, 0.03583098202943802, -0.08611755818128586, 0.2130388766527176, -0.0006030586082488298, -0.006334314588457346, 0.016451969742774963,
-0.22652526199817657, -0.17688798904418945, 0.004681883845478296, 0.45611894130706787, -0.014830286614596844, 0.002217586850747466, 0.03022884763777256, -0.015014358796179295, -0.05341316759586334, 0.06667668372392654,
0.023091541603207588, -0.005800419487059116, 0.15446525812149048, -0.2133273333311081, 0.06759494543075562, -0.1504516899585724, -0.022557351738214493, 0.011015355587005615, -0.020337752997875214, 0.07693897187709808,
-0.07634563744068146, 0.21429714560508728, 0.014143312349915504, -0.20986218750476837, -0.020729446783661842, 0.06638789176940918, 0.24348239600658417, 0.004993635229766369, -0.0008074741344898939, 0.08862144500017166,
-0.07084155082702637, 0.726533830165863, 0.04155348986387253, -0.053597964346408844, -0.016882983967661858, -0.005567589309066534, 0.031414665281772614, 0.0006102368934080005, 0.0050882501527667046, -0.05633321404457092,
-0.09975233674049377, 0.22954563796520233, -0.1696041077375412, 0.11290173977613449, 0.11649914085865021, -0.015015460550785065, -0.049915559589862823, -0.009928140789270401, 0.01998104713857174, -0.006010746583342552,
0.09503120929002762, -0.19840601086616516, -0.33345288038253784, -0.39628684520721436, -0.03697287291288376, 0.09486313909292221, 0.17588841915130615, -0.012309148907661438, -0.04238899052143097, 0.020325643941760063,
-0.23710212111473083, 0.0963103249669075, -0.032492052763700485, -0.5399329662322998, -0.039116546511650085, -0.11311641335487366, 0.021093841642141342, -0.07888885587453842, -0.020170029252767563, -0.27868130803108215,
-0.32453951239585876, -0.09033837169408798, 0.13929513096809387, -0.11737930774688721, 0.004624610301107168, 0.02450457774102688, -0.10505352914333344, 0.027023298665881157, 0.012537495233118534, -0.003795261960476637,
-0.04450754448771477, -0.3028729259967804, 0.2579922378063202, -0.29969361424446106, -0.1487281769514084, -0.045232441276311874, 0.10690285265445709, -0.008316290564835072, 0.02502790093421936, 0.023425910621881485
};

const float nn_moment_biases_fc1[] = {
-0.05514465644955635, -0.316753625869751, -0.3012526035308838, -0.44202372431755066, -0.46467697620391846, -0.07902892678976059, -0.3167324662208557, -0.6723069548606873, -0.06372661143541336, -0.36939406394958496, 0.23663347959518433, -0.379382848739624, -0.3303929269313812, -0.04887673631310463, -0.03462618216872215, -0.0065923710353672504, -0.18684148788452148, -0.5830003023147583, -0.3585696816444397, -0.22169999778270721, -0.4893799126148224, 0.09037352353334427, -0.752585232257843, 0.18032638728618622, -0.1131632924079895, -0.27668002247810364, -0.45771273970603943, -0.2567051947116852, -0.7618073225021362, -0.2729468047618866, 0.1278264820575714, -0.04704355075955391
};

const float nn_moment_weights_fc2[] = {
0.002914609620347619, 0.050493936985731125, 0.019333498552441597, -0.06718894094228745, -0.04059798642992973, -0.0532664880156517, 0.03768543899059296, 0.05837913975119591, -0.010614180006086826, 0.03940984606742859, 0.054026972502470016, -0.06206848472356796, -0.04792001098394394, -0.035759337246418, -0.039306189864873886, 0.03180910646915436, 0.03842912241816521, -0.0757288858294487, 0.03903426229953766, -0.021147223189473152, -0.04278277978301048, 0.06716907769441605, 0.0395134873688221, -0.02360193431377411, -0.04308747872710228, 0.024137012660503387, 0.0882621482014656, 0.01750103570520878, -0.007019430864602327, 0.057990770787000656, -0.022581934928894043, 0.010261107236146927,
-0.07699552923440933, -0.028681304305791855, 0.08666032552719116, -0.017757272347807884, 0.07202025502920151, 0.00041141518158838153, -0.02347089722752571, 0.07058341056108475, 0.06863756477832794, 0.05648663640022278, 0.0017195605905726552, -0.00955642107874155, 0.012102114036679268, 0.018874311819672585, 0.001996766310185194, 0.04629584401845932, 0.017550654709339142, -0.02447817102074623, 0.017070649191737175, 0.04070225730538368, -0.049921486526727676, -0.0016029641265049577, -0.17348435521125793, 0.03681747242808342, -0.03444153070449829, -0.06543461978435516, -0.0736730620265007, -0.04851681739091873, 0.10449386388063431, 0.0014019830850884318, -0.030314859002828598, -0.05838590860366821,
0.0001002439166768454, -0.006411494221538305, 0.011741207912564278, -0.03630973771214485, 0.005827578715980053, 0.012721887789666653, -0.039208218455314636, -0.0001760211307555437, -0.0028991184663027525, 0.0026570232585072517, -0.014781386591494083, -0.0017141613643616438, -0.001504147658124566, 0.01617683470249176, 0.003819422097876668, -0.0012556789442896843, 0.02947462722659111, -0.0015567248919978738, 0.005952793639153242, -0.03729795292019844, 0.00784806814044714, 0.00314711662940681, 0.025738628581166267, 0.008480885066092014, -0.020112842321395874, -0.006915727164596319, -0.018583156168460846, 0.0023378513287752867, 0.015437183901667595, -0.024863967671990395, 0.021244030445814133, 0.0024104746989905834
};

const float nn_moment_biases_fc2[] = {
-0.01039336808025837, -0.009448160417377949, -0.005272675771266222
};

void nn_moment_linear(const float* weights, const float* biases, const float* input, int in_features, int out_features, float* output) {
    for (int i = 0; i < out_features; ++i) {
        float neuron = biases[i];
        for (int j = 0; j < in_features; ++j) {
            neuron += input[j] * weights[i * in_features + j];
        }
        output[i] = neuron;
    }
}

void nn_moment_relu(float* input, int size) {
    for (int i = 0; i < size; ++i) {
        input[i] = fmaxf(0, input[i]);
    }
}

void nn_moment_tanh(float* input, int size) {
    for (int i = 0; i < size; ++i) {
        input[i] = tanh(input[i]);
    }
}

void nn_moment_forward(const float* input, float* output) {
    float fc1_output[32];
    nn_moment_linear(nn_moment_weights_fc1, nn_moment_biases_fc1, input, 10, 32, fc1_output);
    nn_moment_relu(fc1_output, 32);
    nn_moment_linear(nn_moment_weights_fc2, nn_moment_biases_fc2, fc1_output, 32, 3, output);
}
